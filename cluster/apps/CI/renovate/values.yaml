---
apiVersion: v1
kind: ConfigMap
metadata:
  name: renovate-helm-value-overrides
  namespace: flux-ci
data:
  values.yaml: |-
    renovate:
      acceptWhiteSourceTos: 'y'

      renovatePlatform: 'gitlab'
      renovateEndpoint: 'https://${SECRET_GITLAB_DOMAIN}/api/v4/'

      schedulerCron: '*/10 * * * *'

      config: |
        module.exports = {
          // Enter self-hosted configuration options here.
          // https://docs.renovatebot.com/self-hosted-configuration/
          onboardingConfig: {
            extends: ['config:base'],
          },
          gitPrivateKey: '${SECRET_RENOVATE_GIT_PRIVATE_KEY}'
        }

      logLevel: debug

      cachePersistence:
        enabled: true
        accessModes:
          - ReadWriteOnce
          ## Persistent Volume size
        size: 1Gi
        ## The name of an existing PVC to use for persistence
        existingClaim: ""

      existingSecret: whitesource-renovate
