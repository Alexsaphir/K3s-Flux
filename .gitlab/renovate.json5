{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  extends: [
    'config:base',
    'docker:enableMajor',
    ':disableRateLimiting',
    ':dependencyDashboard',
    ':enablePreCommit',
    ':semanticCommits',
    ':automergeDigest',
    ':automergeBranch',
    ':enableVulnerabilityAlerts',

    'github>whitesource/merge-confidence:beta',

    'local>Alexsaphir/K3s-Flux//.gitlab/renovate/commitMessage.json5',
    'local>Alexsaphir/K3s-Flux//.gitlab/renovate/semanticCommits.json5',
    'local>Alexsaphir/K3s-Flux//.gitlab/renovate/groups.json5',
    'local>Alexsaphir/K3s-Flux//.gitlab/renovate/labels.json5'
  ],
  enabled: true,
  semanticCommits: 'enabled',
  configWarningReuseIssue: true,
  configMigration: true,
  dependencyDashboard: true,
  dependencyDashboardTitle: 'Renovate Dashboard',
  suppressNotifications: [
    'prIgnoreNotification'
  ],
  rebaseWhen: 'behind-base-branch',

  lockFileMaintenance: {
    enabled: false
  },
  poetry: {
    enabled: true,
    rangeStrategy: "bump"
  },
  'pre-commit': {
    enabled: true
  },
  flux: {
    fileMatch: [
      'cluster/.+\\.ya?ml$'
    ]
  },
  'helm-values': {
    fileMatch: [
      'cluster/.+\\.ya?ml$'
    ]
  },
  kubernetes: {
    fileMatch: [
      'cluster/.+\\.ya?ml$',
      'provision/ansible/.+\\.ya?ml.j2$'
    ]
  },
  "regexManagers": [
    {
      "description": "Process custom dependencies",
      "fileMatch": [
        "ansible/.+\\.ya?ml$",
        "cluster/.+\\.ya?ml$"
      ],
      "matchStrings": [
        "datasource=(?<datasource>\\S+) depName=(?<depName>\\S+)( versioning=(?<versioning>\\S+))?\n.*?\"(?<currentValue>.*)\"\n"
      ],
      "datasourceTemplate": "{{#if datasource}}{{{datasource}}}{{else}}github-releases{{/if}}",
      "versioningTemplate": "{{#if versioning}}{{{versioning}}}{{else}}semver{{/if}}"
    }
  ],
  packageRules: [
    {
      matchPackageNames: [
        'kube-prometheus-stack',
        'kube-prometheus-stack-crds'
      ],
      groupName: 'kube-prometheus-stack'
    }
  ]
}
