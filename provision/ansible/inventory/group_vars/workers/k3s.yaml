---
k3s_control_node: false

k3s_agent:
  node-ip: "{{ ansible_host }}"

  kubelet-arg:

    # Allow k8s services to contain TCP and UDP on the same port
    - "feature-gates=MixedProtocolLBService=true"

    # Enable Alpha/Beta features
    - "feature-gates=EphemeralContainers=true,ReadWriteOncePod=true"

    # Enables the kubelet to gracefully evict pods during a node shutdown
    - "feature-gates=GracefulNodeShutdown=true"

    # Allow pods to be rescheduled quicker in the case of a node failure
    # https://github.com/k3s-io/k3s/issues/1264
    - "node-status-update-frequency=4s"
